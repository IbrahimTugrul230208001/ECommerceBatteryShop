@model ECommerceBatteryShop.Models.ProductViewModel
@{
    ViewBag.Title = Model.Name;
}

<main class="bg-white min-h-screen pt-28 pb-24">
    <div class="mx-auto max-w-7xl px-4">

        <!-- Grid: image left, info right -->
        <div x-data="{ qty:1, added:false, inc(){ this.qty++; }, dec(){ if(this.qty>1) this.qty--; }, sanitize(){ this.qty=parseInt(this.qty||1,10); if(this.qty<1) this.qty=1; } }" class="grid grid-cols-1 lg:grid-cols-2 gap-10">

            <!-- Left: Image / gallery -->
            <section class="rounded-2xl border border-slate-200 bg-white p-4 sm:p-6 shadow-sm">
                <div class="relative rounded-xl bg-white transition-transform duration-200 overflow-hidden h-[420px] flex items-center justify-center hover:scale-[1.03]">
                    <img src="/img/@(string.IsNullOrWhiteSpace(Model.ImageUrl) ? "temsili.png" : Model.ImageUrl)"
                         alt="@(string.IsNullOrWhiteSpace(Model.Name) ? "Görsel yok" : Model.Name)"
                         class="max-h-full max-w-full object-contain transition-transform duration-200" />
                </div>
            </section>


            <!-- Right: Details -->
            <section class="rounded-2xl border border-slate-200 bg-white p-4 sm:p-6 shadow-sm">
                <h1 class="text-2xl font-semibold text-slate-900">@Model.Name</h1>
                @*
                <!-- Rating -->
                <div class="mt-2 flex items-center gap-2">
                    <div class="flex items-center gap-0.5 text-amber-500">
                        @for (var i = 0; i < 5; i++)
                        {
                            if (i < Model.Rating)
                            {
                                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z" /></svg>
                            }
                            else
                            {
                                <svg class="h-4 w-4 text-slate-300" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z" /></svg>
                            }
                        }
                    </div>
                    <span class="text-xs text-slate-500">(@Model.Rating.ToString("0"))/5</span>
                </div>
                *@
                <!-- Price -->
                <div class="mt-3 text-3xl font-bold tracking-tight text-slate-900">
                    @Model.Price.ToString("C", new System.Globalization.CultureInfo("tr-TR"))
                </div>

                <!-- Description -->
                <div class="mt-4 prose prose-slate max-w-none text-slate-700">
                    <p>@Model.Description</p>
                </div>

                <!-- Qty + Actions -->
                <div class="mt-6 flex flex-wrap items-center gap-3">
                    <!-- Qty input -->
                    <label class="sr-only" for="qty">Adet</label>
                    <div class="inline-flex h-11 items-center rounded-xl border border-slate-300 bg-white shadow-xs">
                        <button type="button"
                                @@click="dec()"
                                class="px-3 h-full text-slate-700 rounded-l-xl hover:bg-slate-200 hover:text-slate-900"
                                aria-controls="qty" aria-label="Azalt">
                            −
                        </button>

                        <input id="qty" type="number" min="1"
                               x-model.number="qty"
                               class="w-10 bg-transparent text-center text-slate-900 outline-none"
                               @@change="sanitize()"
                               aria-live="polite" aria-label="Adet">

                        <button type="button"
                                @@click="inc()"
                                class="px-2 h-full text-slate-700 rounded-r-xl hover:bg-slate-200 hover:text-slate-900"
                                aria-controls="qty" aria-label="Arttır">
                            +
                        </button>
                    </div>

                    <!-- CTA buttons -->
                    <button hx-post="/Cart/Add"
                            :hx-vals="JSON.stringify({ productId: @Model.Id, quantity: qty })"
                            hx-swap="none"
                            x-data="{ added: false }"
                            @@click="if (added) return; added = true; setTimeout(() => added = false, 1600);"
                            :class="added
                                    ? 'bg-green-500 text-white'
                                    : 'bg-amber-300 text-gray-900 hover:bg-amber-400'"
                            class="h-11 min-w-[8rem] rounded-md text-sm font-semibold shadow
           transition-colors duration-300 relative overflow-hidden
           rounded-xl
           focus-visible:ring-yellow-400 cursor-pointer ">
                        <span x-show="!added"
                              x-transition:enter="transition transform ease-out duration-250"
                              x-transition:enter-start="-translate-y-3 opacity-0"
                              x-transition:enter-end="translate-y-0 opacity-100"
                              x-transition:leave="transition transform ease-in duration-200"
                              x-transition:leave-start="translate-y-0 opacity-100"
                              x-transition:leave-end="translate-y-3 opacity-0"
                              class="block">
                            Sepete ekle
                        </span>

                        <span x-show="added"
                              x-transition:enter="transition transform ease-out duration-250"
                              x-transition:enter-start="translate-y-3 opacity-0"
                              x-transition:enter-end="translate-y-0 opacity-100"
                              x-transition:leave="transition transform ease-in duration-200"
                              x-transition:leave-start="translate-y-0 opacity-100"
                              x-transition:leave-end="-translate-y-3 opacity-0"
                              class="absolute inset-0 flex items-center justify-center gap-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path d="M20 6L9 17l-5-5" />
                            </svg>
                            <span class="align-middle">Sepete eklendi</span>
                        </span>
                    </button>

                    <button
                        hx-post='@Url.Action("Add","Cart")'
                        hx-vals='js:{ productId: @Model.Id, quantity: qty }'
                        hx-swap="none"
                        hx-on:htmx:afterRequest="window.location='/Cart/Index'"
                        class="h-11 px-5 rounded-xl cursor-pointer bg-orange-500 text-white font-semibold shadow-sm hover:bg-orange-600 focus:outline-none focus:ring-1 focus:ring-orange-200">
                        Hemen Al
                    </button>
                </div>

                <!-- Small trust badges / info -->
                <ul class="mt-4 text-sm text-slate-600 space-y-1">
                    <li>• 3D Secure desteklenir</li>
                    <li>• Aynı gün kargo (12:00 öncesi)</li>
                </ul>
            </section>
        </div>
    </div>

    </main>
<style>
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    input[type=number] {
        -moz-appearance: textfield;
    }
</style>