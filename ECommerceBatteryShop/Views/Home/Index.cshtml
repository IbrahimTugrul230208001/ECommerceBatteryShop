@using System.Globalization
@{
    ViewData["Title"] = "Home";
}
@model IEnumerable<ECommerceBatteryShop.Models.ProductViewModel>

@{
    var products = Model ?? Array.Empty<ECommerceBatteryShop.Models.ProductViewModel>();
}

<!-- Hero Banner -->
<section class="mb-12">
    <div class="relative rounded-xl overflow-hidden bg-gray-900 text-white">
        <img src="/img/herobanner.png" alt="Batteries" class="w-full h-80 object-cover opacity-60" />
        <div class="absolute inset-0 flex flex-col items-center justify-center text-center px-4">
            <h1 class="text-4xl sm:text-5xl font-bold mb-4">Her an için güç</h1>
            <p class="mb-6 text-lg max-w-2xl">Premium bataryalar ve enerji çözümleri kapýnýza getirilir.</p>
            <a href="/Product/Products" class="px-6 py-3 rounded-md bg-amber-300 text-gray-900 font-semibold hover:bg-amber-400">Ürünler</a>
        </div>
    </div>
</section>

<!-- Features -->
<section class="mb-16 grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="flex items-start gap-4 p-6 bg-white rounded-xl shadow">
        <svg class="w-8 h-8 text-amber-300 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 7h13v8H3z" />
            <path d="M16 7h5l1 2v6h-6V7z" />
            <path d="M5 21a2 2 0 100-4 2 2 0 000 4zM17 21a2 2 0 100-4 2 2 0 000 4z" />
        </svg>
        <div>
            <h3 class="text-lg font-semibold text-gray-900">Fast Delivery</h3>
            <p class="text-sm text-gray-600">Quick and reliable shipping on all orders.</p>
        </div>
    </div>

    <div class="flex items-start gap-4 p-6 bg-white rounded-xl shadow">
        <svg class="w-8 h-8 text-amber-300 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
            <rect x="2" y="7" width="20" height="14" rx="2" ry="2" />
            <path d="M6 7V5a2 2 0 012-2h8a2 2 0 012 2v2" />
        </svg>
        <div>
            <h3 class="text-lg font-semibold text-gray-900">Premium Quality</h3>
            <p class="text-sm text-gray-600">Only the best batteries from trusted brands.</p>
        </div>
    </div>

    <div class="flex items-start gap-4 p-6 bg-white rounded-xl shadow">
        <svg class="w-8 h-8 text-amber-300 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 1a9 9 0 00-9 9v5a3 3 0 003 3h1a1 1 0 001-1v-7a1 1 0 00-1-1H6a1 1 0 00-1 1v4m13-4a1 1 0 00-1-1h-1a1 1 0 00-1 1v7a1 1 0 001 1h1a3 3 0 003-3v-5a9 9 0 00-9-9z" />
        </svg>
        <div>
            <h3 class="text-lg font-semibold text-gray-900">Expert Support</h3>
            <p class="text-sm text-gray-600">Our team is here to help 24/7.</p>
        </div>
    </div>
</section>

<!-- Product Carousel -->
<section class="space-y-6">
    <div class="flex items-center justify-between">
        <h2 class="text-2xl font-bold text-gray-900">Popüler Bataryalar</h2>

        <a href="/Product/Index"
           class="group inline-flex items-center gap-1.5 text-sm font-semibold text-gray-800 hover:text-amber-500">
            Tüm Ürünler
            <svg class="h-4 w-4 transition-transform group-hover:translate-x-0.5"
                 viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 12h14M13 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        </a>
    </div>
    <div x-data="{
         atStart: true, atEnd: false,
         onScroll(){ const el=$refs.scroller; this.atStart=el.scrollLeft<=5; this.atEnd = el.scrollLeft+el.clientWidth>=el.scrollWidth-5; },
         next(){ const el=$refs.scroller; el.scrollBy({left: el.clientWidth, behavior:'smooth'}); },
         prev(){ const el=$refs.scroller; el.scrollBy({left: -el.clientWidth, behavior:'smooth'}); }
       }"
       x-init="onScroll()"
       class="relative">
        <!-- Controls -->
        <button type="button" @@click="prev" :class="{'opacity-40 pointer-events-none': atStart}"
                class="absolute left-2 top-1/2 hover:bg-amber-300 cursor-pointer -translate-y-1/2 z-10 h-10 w-10 grid place-items-center rounded-full bg-white shadow border">
            <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(180)"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.29289 4.29289C8.68342 3.90237 9.31658 3.90237 9.70711 4.29289L16.7071 11.2929C17.0976 11.6834 17.0976 12.3166 16.7071 12.7071L9.70711 19.7071C9.31658 20.0976 8.68342 20.0976 8.29289 19.7071C7.90237 19.3166 7.90237 18.6834 8.29289 18.2929L14.5858 12L8.29289 5.70711C7.90237 5.31658 7.90237 4.68342 8.29289 4.29289Z" fill="#000000"/></svg>
        </button>
        <button type="button" @@click="next" :class="{'opacity-40 pointer-events-none': atEnd}"
                class="absolute right-2 top-1/2 -translate-y-1/2 z-10 h-10 w-10 grid place-items-center text-xl rounded-full bg-white shadow border hover:bg-amber-300 cursor-pointer">
            <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.29289 4.29289C8.68342 3.90237 9.31658 3.90237 9.70711 4.29289L16.7071 11.2929C17.0976 11.6834 17.0976 12.3166 16.7071 12.7071L9.70711 19.7071C9.31658 20.0976 8.68342 20.0976 8.29289 19.7071C7.90237 19.3166 7.90237 18.6834 8.29289 18.2929L14.5858 12L8.29289 5.70711C7.90237 5.31658 7.90237 4.68342 8.29289 4.29289Z" fill="#000000"/></svg>
        </button>

        <!-- Track -->
        <div x-ref="scroller" style="--g:12px" @@scroll.passive="onScroll"
             class="flex gap-[var(--g)] overflow-x-auto snap-x snap-mandatory scroll-smooth hide-scrollbar px-1 py-2">
            @foreach (var product in products)
            {
                    <div class="flex-none  min-w-0 pl-2 lg:basis-[calc((100%-3*var(--g))/4)] md:basis-[calc((100%-2*var(--g))/3)] basis-[calc((100%-1*var(--g))/2)] snap-start">
                    <article class="group h-72 flex flex-col rounded-xl border border-slate-200 bg-white shadow-sm transition hover:shadow-md">
                        <!-- Image -->
                        <a href="/Products" class="block p-3 pb-0">
                            <div class="h-32 grid place-items-center overflow-hidden">
                                    <img src="/img/@product.ImageUrl" alt="@product.Name" class="h-28 w-auto object-contain transition-transform duration-200 group-hover:scale-[1.03]" />
                            </div>
                        </a>
                        <!-- Content -->
                        <div class="px-3 pt-2 flex-1 flex flex-col">
                            <h3 class="text-sm font-semibold text-gray-900 line-clamp-2 min-h-[2.75rem]">@product.Name</h3>
                            <!-- Rating + Price -->
                            <div class="mt-1 flex items-center justify-between">
                                <div class="flex items-center gap-0.5 text-yellow-400">
                                    @for (var i = 0; i < 5; i++)
                                    {
                                        if (i < product.Rating)
                                        {
                                            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z" /></svg>
                                        }
                                        else
                                        {
                                            <svg class="h-4 w-4 text-gray-300" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z" /></svg>
                                        }
                                    }
                                </div>
                                <div class="text-right">
                                        <div class="text-lg font-bold text-gray-900">@product.Price.ToString("C", new CultureInfo("tr-TR"))</div>
                                </div>
                            </div>
                            <!-- Actions -->
                            <div class="mt-3 mb-3 flex items-center gap-2">
                                <button
                                  x-data="{ added: false }"
                                  @@click="
                                    if (added) return;
                                    added = true;
                                    setTimeout(() => added = false, 1600);
                                  "
                                  :class="added
                                    ? 'bg-green-500 text-white'
                                    : 'bg-amber-300 text-gray-900 hover:bg-amber-400'"
                                  class="flex-1 h-9 rounded-md text-sm font-semibold shadow transition-colors duration-300 relative overflow-hidden focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-yellow-400 cursor-pointer"
                                >
                                  <span
                                    x-show="!added"
                                    x-transition:enter="transition transform ease-out duration-250"
                                    x-transition:enter-start="-translate-y-3 opacity-0"
                                    x-transition:enter-end="translate-y-0 opacity-100"
                                    x-transition:leave="transition transform ease-in duration-200"
                                    x-transition:leave-start="translate-y-0 opacity-100"
                                    x-transition:leave-end="translate-y-3 opacity-0"
                                    class="block"
                                  >
                                    Sepete ekle
                                  </span>

                                  <span
                                    x-show="added"
                                    x-transition:enter="transition transform ease-out duration-250"
                                    x-transition:enter-start="translate-y-3 opacity-0"
                                    x-transition:enter-end="translate-y-0 opacity-100"
                                    x-transition:leave="transition transform ease-in duration-200"
                                    x-transition:leave-start="translate-y-0 opacity-100"
                                    x-transition:leave-end="-translate-y-3 opacity-0"
                                    class="absolute inset-0 flex items-center justify-center gap-1"
                                  >
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                      <path d="M20 6L9 17l-5-5"/>
                                    </svg>
                                    <span class="align-middle">Sepete eklendi</span>
                                  </span>
                                </button>

                                <button type="button" class="h-9 w-9 grid place-items-center rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 cursor-pointer">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z" /></svg>
                                </button>
                            </div>
                        </div>
                    </article>
                </div>
            }
        </div>
    </div>
</section>

<script src="~/js/anasayfa.js"></script>
<style>
.hide-scrollbar::-webkit-scrollbar {
  display: none;
}

.hide-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
</style>

