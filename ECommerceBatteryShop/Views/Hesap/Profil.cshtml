@model ECommerceBatteryShop.Models.ProfileViewModel
@{
    Layout = "_Layout";
    ViewData["Title"] = "Profil";

    var rawName = User?.Identity?.IsAuthenticated == true
       ? (string.IsNullOrWhiteSpace(User.Identity?.Name) ? "Değerli Müşteri" : User.Identity!.Name)
       : "Misafir Kullanıcı";

    var displayName = rawName.Replace("-", "").Trim();
}

<section x-data class="bg-gray-50 py-12">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        <div class="mb-10 flex flex-wrap items-center justify-between gap-4">
            <div>
                <p class="text-sm font-semibold uppercase tracking-wide text-amber-500">Hesap Merkezi</p>
                <h1 class="mt-2 text-3xl font-bold text-gray-900">@displayName</h1>
                <p class="mt-1 text-sm text-gray-600">Siparişlerinizi takip edin, ödemelerinizi yönetin ve profil bilgilerinizi güncelleyin.</p>
            </div>
            <a href="/Hesap/LogOut"
               class="flex items-center gap-3 rounded-full border border-red-600 text-red-600 hover:border-red-800 hover:text-red-800 px-6 py-3 text-sm font-semibold shadow-sm transition hover:bg-gray-100 hover:shadow-lg">
                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M 19.2811 49.5156 C 20.5233 49.5156 21.3436 48.6719 21.3436 47.4531 C 21.3436 46.8438 21.1561 46.3984 20.7811 46.0234 L 14.0311 39.4375 L 9.5780 35.6406 L 15.0858 35.8750 L 44.9920 35.8750 C 50.4529 35.8750 52.7267 33.3672 52.7267 28.0703 L 52.7267 14.2188 C 52.7267 8.7578 50.4529 6.4844 44.9920 6.4844 L 31.8671 6.4844 C 30.5780 6.4844 29.7342 7.4219 29.7342 8.5703 C 29.7342 9.7188 30.5780 10.6562 31.8671 10.6562 L 44.9920 10.6562 C 47.4764 10.6562 48.5545 11.7344 48.5545 14.2188 L 48.5545 28.0703 C 48.5545 30.6250 47.4764 31.7031 44.9920 31.7031 L 15.0858 31.7031 L 9.5780 31.9375 L 14.0311 28.1406 L 20.7811 21.5547 C 21.1561 21.1797 21.3436 20.7109 21.3436 20.1016 C 21.3436 18.9062 20.5233 18.0391 19.2811 18.0391 C 18.7655 18.0391 18.1561 18.2969 17.7577 18.6953 L 3.9764 32.2188 C 3.5077 32.6640 3.2733 33.2031 3.2733 33.7891 C 3.2733 34.3516 3.5077 34.9140 3.9764 35.3594 L 17.7577 48.8828 C 18.1561 49.2813 18.7655 49.5156 19.2811 49.5156 Z"></path></g></svg>
                Çıkış yap
            </a>
        </div>

        <div class="grid gap-8 lg:grid-cols-[320px,1fr]">
            <!-- Sol panel -->
            <aside class="space-y-6">
                <div class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-black/5">
                    <div class="flex items-center gap-4">
                        <div class="grid h-16 w-16 place-items-center rounded-full bg-amber-100 text-2xl font-semibold text-amber-600">
                            @(string.IsNullOrWhiteSpace(displayName) ? "?" : displayName.Trim().Substring(0, 1).ToUpperInvariant())
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-500">Üyelik</p>
                            <p class="text-lg font-semibold text-gray-900">@displayName</p>
                        </div>
                    </div>
                </div>

                <nav class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-black/5">
                    <p class="text-xs font-semibold uppercase tracking-wide text-gray-400">Hızlı erişim</p>
                    <ul class="mt-4 space-y-2 text-sm">
                        <li>
                            <a href="#orders" class="group flex items-center justify-between rounded-xl px-4 py-3 transition hover:bg-gray-50">
                                <span class="flex items-center gap-3 text-gray-700 group-hover:text-gray-900">
                                    <svg class="h-4 w-4 text-amber-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M3 7h18M3 12h18M3 17h18" />
                                    </svg>
                                    Siparişlerim
                                </span>
                                <svg class="h-4 w-4 text-gray-400 group-hover:text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 5l7 7-7 7" />
                                </svg>
                            </a>
                        </li>
                        <li>
                            <a href="/Hesap/Ayarlar" class="group flex items-center justify-between rounded-xl px-4 py-3 transition hover:bg-gray-50">
                                <span class="flex items-center gap-3 text-gray-700 group-hover:text-gray-900">
                                    <svg class="h-4 w-4 text-amber-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="3" />
                                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c0 .66.26 1.3.73 1.77.47.47 1.11.73 1.77.73H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" />
                                    </svg>
                                    Ayarlar
                                </span>
                                <svg class="h-4 w-4 text-gray-400 group-hover:text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 5l7 7-7 7" />
                                </svg>
                            </a>
                        </li>
                        <li>
                            <a href="#addresses" class="group flex items-center justify-between rounded-xl px-4 py-3 transition hover:bg-gray-50">
                                <span class="flex items-center gap-3 text-gray-700 group-hover:text-gray-900">
                                    <svg class="h-4 w-4 text-amber-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M2 7h20v10H2z" />
                                        <path d="M16 7V5a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v2" />
                                    </svg>
                                    Adresler
                                </span>
                                <svg class="h-4 w-4 text-gray-400 group-hover:text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 5l7 7-7 7" />
                                </svg>
                            </a>
                        </li>
                    </ul>
                </nav>
            </aside>

            <!-- Sağ içerik -->
            <div class="space-y-8">
                <section id="orders" class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-black/5">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div>
                            <h2 class="text-lg font-semibold text-gray-900">Son Siparişler</h2>
                            <p class="text-sm text-gray-500">Geçmiş siparişlerinizi görüntüleyin ve takip edin.</p>
                        </div>
                    </div>

                    <div class="mt-6 space-y-4">
                        @foreach (var order in Model.Orders)
                        {
                            <article class="rounded-xl border border-gray-100 p-4 transition hover:border-amber-200 hover:shadow-md">
                                <div class="flex flex-wrap items-center justify-between gap-4">
                                    <div> 
                                        <p class="text-sm font-semibold text-gray-900">Sipariş no: @order.OrderId</p>
                                        <p class="text-xs text-gray-500">@order.OrderDate.ToShortDateString()</p>
                                    </div>
                                    <span class="inline-flex  rounded-full bg-emerald-100 px-3 py-1 text-xs font-medium tracking-wide text-emerald-700">@order.Status</span>
                                    <p class="text-base font-semibold text-gray-900">₺@order.TotalAmount</p>
                                </div>

                                <div class="mt-3 space-y-2">
                                    @foreach (var item in order.Items)
                                    {
                                        <div class="flex items-center justify-between text-sm text-gray-700 border-b pb-1">
                                            <img class="h-10 w-10 border border-slate-200 rounded-lg" src="@item.Product.ImageUrl"/>
                                            <span>@item.Product.Name<span>
                                            <span>@item.Quantity x ₺@item.UnitPrice</span>
                                        </div>
                                    }
                                </div>
                            </article>
                        }

                    </div>
                </section>

                <section id="addresses" class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-black/5">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div>
                          
                                <h2 class="text-lg font-semibold text-gray-900">Adresler & Fatura Bilgileri</h2>
                                <p class="text-sm text-gray-500">Teslimat adreslerinizi ve fatura bilgilerinizi yönetin.</p>
                       
                         
                        </div>
                        <button type="button"
                                @@click="$store.address.openNew()"
                                class="inline-flex items-center gap-2 rounded-full border border-amber-400 px-4 py-2 text-sm font-semibold text-amber-600 hover:border-amber-700 hover:text-amber-700">
                            Yeni adres ekle
                            <svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                <path d="M12 5v14" />
                                <path d="M5 12h14" />
                            </svg>
                        </button>
                    </div>

                    @await Html.PartialAsync("_AddressListPartial", Model.Addresses)
                </section>

                <section id="support" class="rounded-2xl bg-gradient-to-br from-gray-900 via-gray-800 to-black p-6 text-white shadow-sm">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div>
                            <h2 class="text-lg font-semibold">Yardıma mı ihtiyacınız var?</h2>
                            <p class="mt-1 text-sm text-gray-300">7/24 destek hattımızdan bize ulaşabilirsiniz. Ortalama yanıt süresi 15 dakikadır.</p>
                        </div>
                        <a href="https://api.whatsapp.com/send/?phone=905013176653" class="inline-flex items-center gap-2 rounded-full bg-amber-300 px-4 py-2 text-sm font-semibold text-gray-900 shadow-sm transition hover:bg-amber-400">
                            Destek ile iletişime geç
                            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                            </svg>
                        </a>
                    </div>
                </section>
            </div>
        </div>
    </div>
</section>
@await Html.PartialAsync("_AddressModalPartial")
